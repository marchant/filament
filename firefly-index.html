<!doctype html>
<html>
<head>
    <title>Montage Studio</title>
    <meta charset="utf-8">

    <base href="/app/">

    <link rel="shortcut icon" href="assets/img/favicon.ico">

    <link href="assets/styles/firefly.css" rel="stylesheet">
    <link href="assets/styles/filament.css" rel="stylesheet">
    <link href="assets/styles/bootstrapping.css" rel="stylesheet">

    <script src="node_modules/montage/montage.js" data-package="/app"></script>
    <script type="text/montage-serialization">
        {
            "owner": {
                "prototype": "montage/ui/loader.reel",
                "properties": {
                    "element": {"#": "loader"}
                },
                "listeners": [
                    {
                        "type": "componentLoaded",
                        "listener": {"@": "applicationDelegate"}
                    }
                ]
            },

            "loaderWidget": {
                "prototype": "ui/widgets/loader.reel",
                "properties": {
                    "element": {"#": "loaderWidget"}
                }
            },

            "status": {
                "prototype": "ui/status.reel",
                "properties": {
                    "element": {"#": "status"},
                    "siteUrl": "status.montagestudio.com",
                    "apiKey": "kwIaGviLwYPXw8LzfozHdQxWxJ8hI1MwtNMRMuxZEeJb2CneR3"
                }
            },

            "toolbar": {
                "prototype": "adaptor/client/ui/toolbar.reel",
                "properties": {
                    "element": {"#": "toolbar"}
                },
                "bindings": {
                    "mainMenu": {"<-": "@application.mainMenu"},
                    "environmentBridge": {"<-": "@applicationDelegate.environmentBridge"},
                    "projectDocument": {"<-": "@applicationDelegate.projectController.projectDocument"}
                }
            },

             "workflow": {
                "prototype": "adaptor/client/ui/workflow.reel",
                "properties": {
                    "element": {"#": "workflow"}
                },
                "bindings": {
                    "projectDocument": {"<-": "@applicationDelegate.projectController.projectDocument"}
                }
            },

            "applicationDelegate": {
                "prototype": "core/firefly-application-delegate",
                "properties": {
                    "promptPanel": {"@": "promptPanel"},
                    "progressPanel": {"@": "progressPanel"},
                    "confirmPanel": {"@": "confirmPanel"},
                    "initializeRepositoryPanel": {"@": "initializeRepoPanel"},
                    "unknownRepositoryPanel": {"@": "unknownRepositoryPanel"},
                    "mergePanel": {"@": "mergePanel"},
                    "mergeConflictPanel": {"@": "mergeConflictPanel"},
                    "infoPanel": {"@": "infoPanel"},
                    "downloadLink": {"#": "downloadLink"}
                }
            },

            "application": {
                "prototype": "montage/core/application",
                "properties": {
                    "delegate": {"@": "applicationDelegate"}
                }
            },

            "modalOverlay": {
                "prototype": "adaptor/client/ui/modal-overlay.reel",
                "properties": {
                    "element": {"#": "modalOverlay"}
                },
                "bindings": {
                    "visible": {"<-": "@applicationDelegate.showModal"},
                    "classList.has('is-booting')": {"<-": "!@applicationDelegate.isProjectLoaded"}
                }
            },

            "unknownRepositoryPanel": {
                "prototype": "adaptor/client/ui/unknown-repository-panel.reel",
                "properties": {
                    "element": {"#": "unknownRepositoryPanel"}
                },
                "bindings": {
                    "owner": {"<-": "@applicationDelegate.environmentBridge.repositoryController.owner"},
                    "repo": {"<-": "@applicationDelegate.environmentBridge.repositoryController.repo"}
                },
                "listeners": [
                    {
                        "type": "createRepository",
                        "listener": {"@": "applicationDelegate"}
                    }
                ]
            },

            "initializeRepoPanel": {
                "prototype": "adaptor/client/ui/initialize-repository-panel.reel",
                "properties": {
                    "element": {"#": "initializeRepoPanel"}
                },
                "bindings": {
                    "owner": {"<-": "@applicationDelegate.environmentBridge.repositoryController.owner"},
                    "repo": {"<-": "@applicationDelegate.environmentBridge.repositoryController.repo"}
                },
                "listeners": [
                    {
                        "type": "initializeRepository",
                        "listener": {"@": "applicationDelegate"}
                    }
                ]
            },

            "mergePanel": {
                "prototype": "adaptor/client/ui/merge-panel.reel",
                "properties": {
                    "element": {"#": "mergePanel"}
                },
                "bindings": {
                    "owner": {"<-": "@applicationDelegate.environmentBridge.repositoryController.owner"},
                    "repo": {"<-": "@applicationDelegate.environmentBridge.repositoryController.repo"}
                }
            },

            "mergeConflictPanel": {
                "prototype": "adaptor/client/ui/merge-conflict-panel.reel",
                "properties": {
                    "element": {"#": "mergeConflictPanel"}
                },
                "bindings": {
                    "owner": {"<-": "@applicationDelegate.environmentBridge.repositoryController.owner"},
                    "repo": {"<-": "@applicationDelegate.environmentBridge.repositoryController.repo"}
                }
            },

            "progressPanel": {
                "prototype": "adaptor/client/ui/progress-panel.reel",
                "properties": {
                    "element": {"#": "progressPanel"}
                }
            },

            "promptPanel": {
                "prototype": "adaptor/client/ui/prompt-panel.reel",
                "properties": {
                    "element": {"#": "promptPanel"}
                }
            },

            "confirmPanel": {
                "prototype": "adaptor/client/ui/confirm-panel.reel",
                "properties": {
                    "element": {"#": "confirmPanel"}
                }
            },

            "infoPanel": {
                "prototype": "adaptor/client/ui/info-panel.reel",
                "properties": {
                    "element": {"#": "infoPanel"}
                }
            },

            "panelSwitcher": {
                "prototype": "montage/ui/substitution.reel",
                "properties": {
                    "element": {"#": "panelSwitcher"}
                },
                "bindings": {
                    "switchValue": {"<-": "@applicationDelegate.currentPanelKey"}
                }
            }

        }
    </script>

</head>
<body class="Filament">

    <div data-montage-id="status"></div>

    <section data-montage-id="modalOverlay" class="ModalOverlay-noDisplay">
        <div data-montage-id="panelSwitcher" data-arg="panel" class="ModalOverlay-switcher">
            <div data-arg="unknown" data-montage-id="unknownRepositoryPanel" class="ModalOverlay-item"></div>
            <div data-arg="initialize" data-montage-id="initializeRepoPanel" class="ModalOverlay-item"></div>
            <div data-arg="merge" data-montage-id="mergePanel" class="ModalOverlay-item"></div>
            <div data-arg="conflict" data-montage-id="mergeConflictPanel" class="ModalOverlay-item"></div>
            <div data-arg="progress" data-montage-id="progressPanel" class="ModalOverlay-item"></div>
            <div data-arg="prompt" data-montage-id="promptPanel" class="ModalOverlay-item"></div>
            <div data-arg="confirm" data-montage-id="confirmPanel" class="ModalOverlay-item"></div>
            <div data-arg="info" data-montage-id="infoPanel" class="ModalOverlay-item"></div>
        </div>
        <a href="" data-montage-id="downloadLink" download="download"></a>
    </section>

    <nav data-montage-id="toolbar">
        <div data-montage-id="workflow"></div>
    </nav>

    <div data-montage-id="loader" class="Filament-loader--firefly">
        <div data-montage-id="loaderWidget"></div>
    </div>

    <script>
    var _rollbarConfig = {accessToken: "3cccf5107ff04046a83d0b55ffbf8861", captureUncaught: true};
    !function(a,b){function c(b){this.shimId=++f,this.notifier=null,this.parentShim=b,this.logger=function(){},a.console&&void 0===a.console.shimId&&(this.logger=a.console.log)}function d(b){var d=c;return e(function(){if(this.notifier)return this.notifier[b].apply(this.notifier,arguments);var c=this,e="scope"===b;e&&(c=new d(this));var f=Array.prototype.slice.call(arguments,0),g={shim:c,method:b,args:f,ts:new Date};return a._rollbarShimQueue.push(g),e?c:void 0})}function e(a,b){return b=b||this.logger,function(){try{return a.apply(this,arguments)}catch(c){b("Rollbar internal error:",c)}}}var f=0;c.init=function(a,b){var d=b.globalAlias||"Rollbar";if("object"==typeof a[d])return a[d];a._rollbarShimQueue=[],b=b||{};var f=new c;return e(function(){if(f.configure(b),b.captureUncaught){var c=a.onerror;a.onerror=function(){f.uncaughtError.apply(f,arguments),c&&c.apply(a,arguments)}}return a[d]=f,f},f.logger)()},c.prototype.loadFull=function(a,b,c,d){var f=e(function(){var a=b.createElement("script"),e=b.getElementsByTagName("script")[0];a.src=d.rollbarJsUrl,a.async=!c,a.onload=g,e.parentNode.insertBefore(a,e)},this.logger),g=e(function(){if(void 0===a._rollbarPayloadQueue)for(var b,c,d,e,f=new Error("rollbar.js did not load");b=a._rollbarShimQueue.shift();)for(d=b.args,e=0;e<d.length;++e)if(c=d[e],"function"==typeof c){c(f);break}},this.logger);e(function(){c?f():a.addEventListener?a.addEventListener("load",f,!1):a.attachEvent("onload",f)},this.logger)()};for(var g="log,debug,info,warn,warning,error,critical,global,configure,scope,uncaughtError".split(","),h=0;h<g.length;++h)c.prototype[g[h]]=d(g[h]);var i="//d37gvrvc0wt4s1.cloudfront.net/js/v1.0/rollbar.min.js";_rollbarConfig.rollbarJsUrl=_rollbarConfig.rollbarJsUrl||i;var j=c.init(a,_rollbarConfig);j.loadFull(a,b,!1,_rollbarConfig)}(window,document);
    </script>

    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-35717912-3', 'montagestudio.com');
        ga('send', 'pageview');
    </script>
</body>
</html>
