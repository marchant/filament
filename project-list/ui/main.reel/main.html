<!doctype html>
<html>
<head>
    <title>Main</title>
    <meta charset="utf-8">

    <link href="main.css" rel="stylesheet" />
    <link href="/assets/styles/filament-matte.css" rel="stylesheet" />

    <script type="text/montage-serialization">
        {
            "localizer": {
                "object": "montage/core/localizer[defaultLocalizer]"
            },

            "owner": {
                "properties": {
                    "element": {"#": "main"}
                },
                "bindings": {
                    "projects.Recent": {"<-": "@repositoriesController.recentRepositoriesContent.organizedContent"},
                    "projects.Owned": {"<-": "@repositoriesController.ownedRepositoriesContent.organizedContent"}
                },
                "listeners": [
                    {
                        "type": "openDocument",
                        "listener": {"@": "owner"}
                    }
                ]
            },
            
            "newAppButtonCondition": {
                "prototype": "montage/ui/condition.reel",
                "properties": {
                    "element": {"#": "newAppButtonCondition"},
                    "removalStrategy": "hide"
                },
                "bindings": {
                    "condition": {"<-": "!@owner.showNewAppForm"}
                }
            },

            "newAppButton": {
                "prototype": "matte/ui/button.reel",
                "properties": {
                    "element": {"#": "newAppButton"}
                },
                "localizations": {
                    "label": {"key": "new_application"}
                },
                "listeners": [
                    {
                        "type": "action",
                        "listener": {"@": "owner"}
                    }
                ]
            },

            "newAppFormCondition": {
                "prototype": "montage/ui/condition.reel",
                "properties": {
                    "element": {"#": "newAppFormCondition"},
                    "removalStrategy": "hide"
                },
                "bindings": {
                    "condition": {"<-": "@owner.showNewAppForm"}
                }
            },

            "newAppName": {
                "prototype": "matte/ui/input-text.reel",
                "properties": {
                    "element": {"#": "newAppName"},
                    "value": ""
                },
                "listeners": [
                    {
                        "type": "action",
                        "listener": {"@": "owner"}
                    }
                ]
            },

            "newAppDescription": {
                "prototype": "matte/ui/textarea.reel",
                "properties": {
                    "element": {"#": "newAppDescription"},
                    "value": ""
                }
            },

            "newAppError": {
                "prototype": "montage/ui/text.reel",
                "properties": {
                    "element": {"#": "newAppError"},
                    "value": ""
                }
            },

            "createNewAppButton": {
                "prototype": "matte/ui/button.reel",
                "properties": {
                    "element": {"#": "createNewAppButton"},
                    "label": "Create"
                },
                "bindings": {
                    "disabled": {"<-": "@newAppName.value.length == 0"}
                },
                "listeners": [
                    {
                        "type": "action",
                        "listener": {"@": "owner"}
                    }
                ]
            },

            "cancelNewAppButton": {
                "prototype": "matte/ui/button.reel",
                "properties": {
                    "element": {"#": "cancelNewAppButton"},
                    "label": "Cancel"
                },
                "listeners": [
                    {
                        "type": "action",
                        "listener": {"@": "owner"}
                    }
                ]
            },

            "recentTitle": {
                "prototype": "montage/ui/text.reel",
                "properties": {
                    "element": {"#": "recentTitle"}
                },
                "localizations": {
                    "value": {"key": "recent_projects"}
                }
            },

            "removeWorkspaces": {
                "prototype": "matte/ui/button.reel",
                "properties": {
                    "element": {"#": "removeWorkspaces"}
                },
                "bindings": {
                    "enabled": {"<-": "@owner.workspaces.length > 0"}
                },
                "localizations": {
                    "label": {
                        "key": "remove_workspaces",
                        "default": "{number, plural, =0 {Delete workspaces} one {Delete 1 workspace} other {Delete # workspaces}}",
                        "data": {
                            "number": {"<-": "@owner.workspaces.length || 0"}
                        }
                    }
                },
                "listeners": [
                    {"type": "action", "listener": {"@": "owner"}}
                ]
            },

            "historyProgress": {
                "prototype": "matte/ui/progress.reel",
                "properties": {
                    "element": {"#": "historyProgress"}
                },
                "bindings": {
                    "max": {"<-": "@repositoriesController.repositoriesCount"},
                    "value": {"<-": "[value, @repositoriesController.processedRepositories].max{}"},
                    "classList.has('is-done')": {"<-": "[value, @repositoriesController.processedRepositories].max{} >= [max, @repositoriesController.repositoriesCount].min{}"}
                }
            },

            "historyRefresh": {
                "prototype": "matte/ui/button.reel",
                "properties": {
                    "element": {"#": "historyRefresh"}
                },
                "listeners": [
                    {"type": "action", "listener": {"@": "owner"}}
                ]
            },

            "historyEmpty": {
                "prototype": "montage/ui/condition.reel",
                "properties": {
                    "element": {"#": "historyEmpty"},
                    "removalStrategy": "hide"
                },
                "bindings": {
                    "condition": {"<-": "@historyProgress.max == @historyProgress.value && @owner.projects.Owned.length == 0"}
                }
            },

            "historyEmptyTitle": {
                "prototype": "montage/ui/text.reel",
                "properties": {
                    "element": {"#": "historyEmptyTitle"}
                },
                "localizations": {
                    "value": {"key": "empty_projects"}
                }
            },

            "historyList": {
                "prototype": "montage/ui/repetition.reel",
                "properties": {
                    "element": {"#": "historyList"}
                },
                "bindings": {
                    "contentController": {"<-": "@repositoriesController.contentController"}
                }
            },
            "historyListItem": {
                "prototype": "../history-list-item.reel",
                "properties": {
                    "element": {"#": "historyListItem"},
                    "repositoriesController": {"@": "repositoriesController"}
                },
                "bindings": {
                    "repository": {
                        "<-": "@historyList:iteration.object"
                    }
                }
            },
            "repositoriesController": {
                "prototype": "../../core/repositories-controller"
            },
            "username": {
              "prototype": "montage/ui/text.reel",
              "properties": {
                  "element": {"#": "username"}
              },
              "bindings": {
                  "value": {
                      "<-": "@owner.userController.user.name"
                  }
              }
            },
            
            "avatar": {
              "prototype": "matte/ui/image.reel",
              "properties": {
                  "element": {"#": "avatar"}
              },
              "bindings": {
                  "src": {
                      "<-": "@owner.userController.user.avatarUrl"
                  }
              }
            },
            "beta": {
                "prototype": "ui/widgets/beta.reel",
                "properties": {
                    "element": {"#": "beta"}
                }
            },
            "copyright": {
                "prototype": "montage/ui/text.reel",
                "properties": {
                    "element": {"#": "copyright"}
                },
                "localizations": {
                    "value": {"key": "copyright"}
                }
            },
            "explorePopcornButton": {
                "prototype": "matte/ui/button.reel",
                "properties": {
                    "element": {"#": "explorePopcornButton"}
                },
                "bindings": {
                    "label": {"<-": "!!@repositoriesController.ownedRepositoriesContent.organizedContent.map{name}.has('popcorn') ? 'Open Popcorn' : 'Fork Popcorn'"},
                    "detail.get('owner')": {"<-": "'montagejs'"},
                    "detail.get('repository')": {"<-": "'popcorn'"}
                },
                "listeners": [
                    {
                        "type": "action",
                        "listener": {"@": "owner"}
                    }
                ]
            },
    
            "exploreTodoButton": {
                "prototype": "matte/ui/button.reel",
                "properties": {
                    "element": {"#": "exploreTodoButton"}
                },
                "bindings": {
                    "label": {"<-": "!!@repositoriesController.ownedRepositoriesContent.organizedContent.map{name}.has('studio-todo') ? 'Open Todo' : 'Fork Todo'"},
                    "detail.get('owner')": {"<-": "'montagejs'"},
                    "detail.get('repository')": {"<-": "'studio-todo'"}
                },
                "listeners": [
                    {
                        "type": "action",
                        "listener": {"@": "owner"}
                    }
                ]
            }
        }
    </script>

</head>
<body>

    <div data-montage-id="main" class="Main">

        <aside class="Aside">
                
            <div class="Aside-content">
                
                <div data-montage-id="beta"></div>
                
                <section class="Aside-section">
                    <img class="Aside-logo" src="../../../assets/img/logo.svg" alt="Montage Studio">
                </section>
                
                <section class="Aside-section">
                    <h2 class="Aside-title">Get Started</h2>
                    <ul class="Aside-list">
                        <li>
                            <span><a href="http://docs.montagestudio.com/montage-studio/ide-at-a-glance.html" target="_blank">Overview</a></span>
                            <span>Take a tour of Montage Studio.</span>
                        </li>
                        <li>
                            <span><button data-montage-id="exploreTodoButton"></button></span>
                            <span>Fork and explore a simple MontageJS application.</span>
                        </li>
                        <li>
                            <span><button data-montage-id="explorePopcornButton"></button></span>
                            <span>Fork and explore a complex MontageJS application.</span>
                        </li>
                        <li>
                            <span><a href="http://docs.montagestudio.com/montage-studio/tutorial-simple-to-do.html" target="_blank">Quick Start</a></span>
                            <span>Build a simple application.</span>
                        </li>
                    </ul>
                </section>
                
                <section class="Aside-section">
                    <h2 class="Aside-title">Help and Support</h2>
                    <p class="Aside-links">
                        <a href="http://docs.montagestudio.com/montage-studio/" target="_blank">Documentation</a>
                        <a href="http://forum.montagestudio.com" target="_blank">Forum</a>
                    </p>
                    </ul>
                </section>
                
                <section class="Aside-section">
                    <h2 class="Aside-title">Follow Us</h2>
                    <p class="Aside-links">
                        <a href="http://montagestudio.com/blog/" target="_blank">Blog</a>
                    </p>
                </section>
                
                            
                <section class="Aside-section">
                    <p>Need help? <a href="http://webchat.freenode.net/?channels=montage" target="_blank">Chat with the team</a>.</p>
                    
                    <p data-montage-id="copyright" class="Aside-meta"></p>
                </section>
            </div>
    
        </aside>

        <section class="Intro Examples Column" style="display: none;">
            <ul class="Intro-examples">
                <li class="Intro-examples--featured">
                    <img src="../../assets/images/todo.jpg" class="Intro-examples-image">
                    <p class="Intro-examples-description">Learn the basics by editing the simple todo-list application described in <a href="http://docs.montagestudio.com/montage-studio/tutorial-simple-to-do.html" target="_blank" data-montage-id="openDocs" class="Button Button--action">our tutorial</a>.</p>
                    <button data-montage-id="exploreTodoButton" class="Button Button--action"></button>
                </li>
                <li class="Intro-examples--featured">
                    <img src="../../assets/images/popcorn.jpg" class="Intro-examples-image">
                    <p class="Intro-examples-description">Explore a real-world application that includes many different components.</p>
                    <button data-montage-id="explorePopcornButton" class="Button Button--action"></button>
                </li>
            </ul>
        </section>


        <div class="Projects">
            <section class="Projects-section">
                <img data-montage-id="avatar" class="User-avatar" src="">
                <span data-montage-id="username" class="User-name"></span>
            </section>

            <section class="Projects-section">
                <div data-montage-id="newAppButtonCondition">
                    <div class="Action">
                        <button data-montage-id="newAppButton" class="Action-button Action-button--new"></button>
                    </div>
                </div>
                <div data-montage-id="newAppFormCondition" class="NewForm">
                    <label class="NewForm-field">
                        Name <input type="text" data-montage-id="newAppName" placeholder="my-app">
                    </label>
                    <label class="NewForm-field">
                        Description <textarea data-montage-id="newAppDescription" placeholder="(optional)"></textarea>
                    </label>
                    <div data-montage-id="newAppError" class="NewForm-error"></div>
                    <footer class="NewForm-bar">
                        <button data-montage-id="cancelNewAppButton" class="Button"></button>
                        <button data-montage-id="createNewAppButton" class="Button Button--action"></button>
                    </footer>
                </div>
            </section>

            <section class="Projects-section History">
                <div class="Title-section">
                    <h2 data-montage-id="recentTitle" class="Launcher-title"></h2>
                    <button data-montage-id="historyRefresh" data-arg="" aria-label="Refresh project list" class="Button History-refresh"></button>
                </div>
                <div data-montage-id="updatingRepositories" class="History-update">
                    <div data-montage-id="historyProgress" class="History-progress"></div>
                </div>
                <div data-montage-id="historyEmpty" class="History-empty">
                    <span data-montage-id="historyEmptyTitle"></span>
                </div>
                <ul class="History-list" data-montage-id="historyList">
                    <li class="History-list-item" data-montage-id="historyListItem"></li>
                </ul>
            </section>

            <button data-montage-id="removeWorkspaces" class="Button"></button>

        </section>

    </div>

</body>
</html>
